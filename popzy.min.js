Popzy.stack=[];Popzy.baseZIndex=1e3;function Popzy(options={}){this.otps=Object.assign({destroyOnclose:true,classCss:[],footer:false,closeMethod:["button","backdrop","escape"]},options);const{closeMethod:closeMethod}=this.otps;this._allowButton=closeMethod.includes("button");this._allowBackdrop=closeMethod.includes("backdrop");this._allowEscape=closeMethod.includes("escape");this._footerButtons=[];this.template=document.querySelector(`#${this.otps.templateId}`);if(!this.template){throw new Error(`Template with id "${this.otps.templateId}" does not exist`)}this._handleEsc=this._handleEsc.bind(this)}Popzy.prototype._handleEsc=function(e){const lastStack=Popzy.stack.at(-1);if(e.key==="Escape"&&this===lastStack){this.close()}};Popzy.prototype._clearUp=function(destroy){if(!this._backdrop)return;if(destroy){this._backdrop.remove();this._backdrop=null;this._modalFooter=null}if(!Popzy.stack.length){document.body.classList.remove("popzy__no-scroll");document.body.style.paddingRight=""}if(this._allowEscape){document.body.removeEventListener("keydown",this._handleEsc)}};Popzy.prototype._createButton=function(title,className,callback){const button=document.createElement("button");button.innerHTML=title;button.className=className;button.addEventListener("click",callback);return button};Popzy.prototype._updateZIndex=function(){Popzy.stack.forEach((modal,index)=>{if(modal._backdrop){modal._backdrop.style.zIndex=Popzy.baseZIndex+index*2;modal._backdrop.querySelector(".popzy__container").style.zIndex=Popzy.baseZIndex+index*2+1}})};Popzy.prototype._build=function(){this._backdrop=document.createElement("div");this._backdrop.className="popzy__backdrop";const container=document.createElement("div");container.className="popzy__container";if(Array.isArray(this.otps.classCss)){this.otps.classCss.forEach(cssClass=>{if(typeof cssClass==="string"&&cssClass.trim()){container.classList.add(cssClass.trim())}else{console.warn(`Invalid class name: ${cssClass}`)}})}const modalContent=document.createElement("div");modalContent.className="popzy__content";const content=this.template.content.cloneNode(true);modalContent.append(content);container.append(modalContent);if(this.otps.footer){this._modalFooter=document.createElement("div");this._modalFooter.className="popzy__footer";if(this._footerContent){this._modalFooter.innerHTML=this._footerContent}this._footerButtons.forEach(button=>{this._modalFooter.append(button)});container.append(this._modalFooter)}this._backdrop.append(container);document.body.append(this._backdrop);if(this._allowButton){const button=this._createButton("&times;","popzy__close",()=>this.close());container.append(button)}};Popzy.prototype.setFooterContent=function(html){this._footerContent=html;if(this._modalFooter){this._modalFooter.innerHTML=this._footerContent}};Popzy.prototype.addFooterButton=function(title,className,callback){const button=this._createButton(title,className,callback);this._footerButtons.push(button)};Popzy.prototype.open=function(){if(!this._backdrop)this._build();if(!Popzy.stack.includes(this)){Popzy.stack.push(this)}else{const index=Popzy.stack.indexOf(this);Popzy.stack.splice(index,1);Popzy.stack.push(this)}this._updateZIndex();setTimeout(()=>{this._backdrop.classList.add("show")},5);if(this._allowBackdrop){this._backdrop.addEventListener("click",e=>{if(e.target===this._backdrop){this.close()}})}if(this._allowEscape){document.body.addEventListener("keydown",this._handleEsc)}document.body.classList.add("popzy__no-scroll");const scrollWidth=this._getScrollBarWidth();if(scrollWidth>0){document.body.style.paddingRight=scrollWidth+"px"}if(typeof this.otps.onOpen==="function")this.otps.onOpen();return this._backdrop};Popzy.prototype.close=function(destroy=this.otps.destroyOnclose){if(!this._backdrop)return;if(typeof this.otps.onClose==="function")this.otps.onClose();this._backdrop.classList.remove("show");const index=Popzy.stack.indexOf(this);if(index!==-1){Popzy.stack.splice(index,1)}this._updateZIndex();this._backdrop.addEventListener("transitionend",()=>this._clearUp(destroy),{once:true})};Popzy.prototype.destroy=function(){this.close(true)};Popzy.prototype._getScrollBarWidth=function(){if(this._getScrollBarWidth.value)return this._getScrollBarWidth.value;const div=document.createElement("div");Object.assign(div.style,{position:"absolute",top:"-99999px",overflow:"scroll"});document.body.append(div);const getScrollWidth=div.offsetWidth-div.clientWidth;this._getScrollBarWidth.value=getScrollWidth;document.body.removeChild(div);return getScrollWidth};